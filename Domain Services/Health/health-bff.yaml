openapi: 3.0.1
info:
  title: Campaign Manager
  description: BFF service APIs - to Bulk create, search and fetch all data in a registry.
  contact:
    name: eGov
    email: info@egovernments.org
  version: 1.0.0
servers:
- url: /campaign-manager/v1
paths:
  /campaign-manager/data/v1/_create:
    post:
      tags:
      - Bulk Data Creation
      summary: "This API endpoint used to do a bulk upload of data based on type"
      description: "This API endpoint used to do a bulk upload of data based on type"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/BulkResourceCreateRequest"
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkResourceCreateResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
  /campaign-manager/data/v1/_search:
    post:
      tags:
      - Bulk Data Creation
      summary: "This API endpoint searches for API resources"
      description: "This API endpoint searches for API resources"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/SearchRequest"   
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkResourceCreateResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
  /campaign-manager/data/v1/_generate:
    post:
      tags:
      - Bulk Data Creation
      summary: "This API endpoint updates the API resources table"
      description: "This API endpoint updates the API resources table"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                RequestInfo:
                  $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
      parameters:
      - name: tenantId
        in: query
        description: unique id for a tenant.
        required: true
        schema:
          maxLength: 256
          type: string
          format: varchar
      - name: type
        in: query
        description: type of the resource
        required: true
        schema:
          maxLength: 256
          type: string
          format: varchar
      - name: forceUpdate
        in: query
        description: "ForceUpdate parameter"
        required: false
        schema:
          type: boolean
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkGenerateResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
  /campaign-manager/data/v1/_download:
    post:
      tags:
      - Bulk Data Creation
      summary: "This API endpoint updates the API resources table"
      description: "This API endpoint updates the API resources table"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                RequestInfo:
                  $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
      parameters:
      - name: tenantId
        in: query
        description: unique id for a tenant.
        required: true
        schema:
          maxLength: 256
          type: string
          format: varchar
      - name: type
        in: query
        description: type of the resource
        required: true
        schema:
          maxLength: 256
          type: string
          format: varchar
      - name: id
        in: query
        description: unique id of the generated request
        required: false
        schema:
          maxLength: 256
          type: string
          format: varchar
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkDownloadResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
  /campaign-manager/process/v1/boundary:
    post:
      tags:
      - Process API
      summary: "This API endpoint used to do a bulk upload of data based on type"
      description: "This API endpoint used to do a bulk upload of data based on type"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                RequestInfo:
                  $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
                ResourceDetails:
                  $ref: '#/components/schemas/BoundaryResourceDetails'
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkResourceCreateResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
  /campaign-manager/process/v1/create-campaign:
    post:
      tags:
      - Process API
      summary: "This API endpoint used to do a bulk upload of data based on type"
      description: "This API endpoint used to do a bulk upload of data based on type"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                RequestInfo:
                  $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
                ResourceDetails:
                  $ref: '#/components/schemas/CampaignResourceDetails'
      responses:
        200:
          description: Successful Response.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/BulkResourceCreateResponse'
        400:
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ErrorRes'
components:
  schemas:
    BulkResourceCreateRequest:
      type: object
      properties:
        RequestInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
        ResourceDetails:
          $ref: '#/components/schemas/ResourceDetails'
    ResourceDetails:
      type: object
      properties:
        type:
          type: "string"
        tenantId:
          type: "string"
        fileStoreId:
          type: "string"
    BoundaryResourceDetails:
      type: object
      properties:
        hierarchyType:
          type: "string"
        tenantId:
          type: "string"
        fileStoreId:
          type: "string"
    CampaignResourceDetails:
      type: object
      properties:
        hierarchyType:
          type: "string"
        tenantId:
          type: "string"
        campaignName:
          type: "string"
        filestoreIds:
          type: "array"
          items:
            type: "object"
            properties:
              filestoreId:
                type: "string"
                example: "cf3bd20c-5ac3-4af1-a303-55445049b289"
              type:
                type: "string"
                example: "user"
              filename:
                type: "string"
                example: "user.xlsx"
        projectType:
          type: "string"
        additionalDetails:
          type: "object"
    BulkResourceCreateResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ResponseInfo'
        ResponseDetails:
          $ref: '#/components/schemas/CreateResponseDetails'
    CreateResponseDetails:
      type: "object"
      properties:
        id:
          type: "string"
          example: "cf3bd20c-5ac3-4af1-a303-55445049b289"
        tenantId:
          type: "string"
        status:
          type: "string"
          example: "data-accepted"
        processReferenceNumber:
          type: "string"
          example: "PRO-001-001-001"
        fileStoreId:
          type: "string"
          example: "a47e3f92-5c05-4abf-bf4e-17d2d4a35a72"
        type:
          type: "string"
          example: "facility"
    SearchRequest:
      type: object
      properties:
        RequestInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/RequestInfo'
        SearchCriteria:
          type: "object"
          properties:
            id:
              type: "array"
              items:
                type: "string"
            tenantId:
              type: "string"
            processReferenceNumber:
              type: "string"
            type:
              type: "string"
    SearchResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ResponseInfo'
        ResponseDetails:
          type: "array"
          items:
            type: "object"
            properties:
              status:
                type: "string"
                example: "data-accepted"
              id:
                type: "string"
                example: "cf3bd20c-5ac3-4af1-a303-55445049b289"
              tenantId:
                type: "string"
              processReferenceNumber:
                type: "string"
                example: "PRO-001-001-001"
              fileStoreId:
                type: "string"
                example: "a47e3f92-5c05-4abf-bf4e-17d2d4a35a72"
              type:
                type: "string"
                example: "facility"
              additionalDetails:
                type: "object"
                example: {}
              auditDetails:
                type: "object"
                properties:
                  createdBy:
                    type: "string"
                    example: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  lastModifiedBy:
                    type: "string"
                    example: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  createdTime:
                    type: "string"
                    example: "1644426612"
                  lastModifiedTime:
                    type: "string"
                    example: "1644426612"
            example:
              - status: "data-accepted"
                id: "cf3bd20c-5ac3-4af1-a303-55445049b289"
                tenantId: "pg.citya"
                processReferenceNumber: "PRO-001-001-001"
                fileStoreId: "a47e3f92-5c05-4abf-bf4e-17d2d4a35a72"
                type: "facility"
                additionalDetails: {}
                auditDetails:
                  createdBy: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  lastModifiedBy: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  createdTime: "1644426612"
                  lastModifiedTime: "1644426612"
              - status: "data-rejected"
                id: "7cb9e05f-0cb4-4386-b221-1f8a001d4e0c"
                tenantId: "pg.citya"
                processReferenceNumber: "PRO-001-001-002"
                fileStoreId: "5a2e0b15-fd7d-44ee-8ef7-811722a15e6f"
                type: "service"
                additionalDetails: {}
                auditDetails:
                  createdBy: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  lastModifiedBy: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                  createdTime: "1644426612"
                  lastModifiedTime: "1644426612"
    BulkGenerateResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ResponseInfo'
        GeneratedResource:
          type: "object"
          properties:
            id:
              type: "string"
              example: "c0ab3641-97bb-4601-9a8a-60bb9db59708"
            type:
              type: "string"
              example: "facility"
            status:
              type: "string"
              example: "generation started"
            tenantId:
              type: "string"
              example: "pg.citya"
    BulkDownloadResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-Specs/master/Common%20Services/common-contract.yaml#/components/schemas/ResponseInfo'
        GeneratedResource:
          type: "object"
          properties:
            id:
              type: "string"
              example: "c0ab3641-97bb-4601-9a8a-60bb9db59708"
            tenantId:
              type: "string"
              example: "pg.citya"
            fileStoreid:
              type: "string"
              example: "c0ab3641-97bb-4601-9a8a-60bb9db59708"
            type:
              type: "string"
              example: "facility"
            status:
              type: "string"
              example: "completed"
            count:
              type: "number"
              example: 100
            url:
              type: "string"
              example: "https://unified-uat-filestore.s3-ap-south-1.amazonaws.com/mz/pgr/February/8/1707393265007mXVKObMAqy.xlsx?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAVCURO6LLX5SS6CNF%2F20240209%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20240209T091624Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=507dd50aa25be05789aaf0c0f4cdcb1555f59053b299fef5228f218eb67e3218"
            additionalDetails:
              type: "object"
              example : {}
            auditDetails:
              type: "object"
              properties:
                createdBy:
                  type: "string"
                  example: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                lastModifiedBy:
                  type: "string"
                  example: "a1b2c3d4-e5f6-g7h8-i9j0-k1l2m3n4o5p6"
                createdTime:
                  type: "string"
                  example: "1644426612"
                lastModifiedTime:
                  type: "string"
                  example: "1644426612"
