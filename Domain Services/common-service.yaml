openapi: 3.0.0
info:
  version: 1.0.0
  title: Generic Service 
  description: Application Service
paths:
  /generic-service/v1/_init:
    post:
      tags:
        - Generic Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceInitRequest'
      responses:
        '202':
          description: Accepted account registration request.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ServiceInitResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes
  /application-service/v1/_apply:
    post:
      tags:
        - Application Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationRequest'
      responses:
        '202':
          description: Accepted account registration request.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ApplicationResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes
  /application-service/v1/_update:
    post:
      tags:
        - Application Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationRequest'
      responses:
        '202':
          description: Accepted account updation request.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ApplicationResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes
  /application-service/v1/_search:
    post:
      tags:
        - Application Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationSearchRequest'
      responses:
        '200':
          description: Return search results
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ApplicationResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes

  /record-service/v1/_create:
    post:
      tags:
        - Record Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecordRequest'
      responses:
        '202':
          description: Accepted account registration request.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/RecordResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes
  /record-service/v1/_update:
    post:
      tags:
        - Record Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecordRequest'
      responses:
        '202':
          description: Accepted account updation request.
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/RecordResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes
  /record-service/v1/_search:
    post:
      tags:
        - Record Service
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecordSearchRequest'
      responses:
        '200':
          description: Return search results
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/RecordResponse'
        '400':
          description: Invalid input.
          content:
            '*/*':
              schema:
                $ref: >-
                  https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ErrorRes

components:
  schemas:
    Address:
      allOf:
        - $ref: "https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract.yml#/definitions/Address"
        - type: object
          properties:
            hierarchyType:
              type: string
              description: "Hierarchy type of the address"
            boundarylevel:
              type: string
              description: "Level associated with the address"
            boundarycode:
              type: string
              description: "Code representing the address"  
    Application:
      description: A Object which holds the info about the application details
      type: object
      properties:
        id:
          description: Unique identifier of the record
          readOnly: true
          type: string
          minLength: 2
          maxLength: 64
          example: "8801de85-f123-4e4b-9e4e-adbd04e49965"
        tenantId:
          description: Tenant Identifier
          example: pg
          type: string
          minLength: 2
          maxLength: 64
        module:
          type: string
          description: all the enabled service like tradelicence / propertytax etc
          minLength: 2
          maxLength: 64
          example: tradelicence
        businessService:
          description: captures the businessService information to be used in workflow service like NEWTL / RENEWTL NEWPROPERTY etc
          example: NEWTL
          type: string
          minLength: 2
          maxLength: 64
        
        applicationNo:
          maxLength: 64
          minLength: 2
          type: string
          description: Unique Application Number. This is  unique in
            system for a tenant. This is mandatory but always be generated after validation.
          readOnly: true
        status:
          $ref: '#/components/schemas/Status'
        channel:
          description: channel which this application created like citizen/ employee/ system
          example: citizen
          type: string
          minLength: 2
          maxLength: 64  
        references:
          type: array
          items:
            $ref: '#/components/schemas/Reference'

        workflowStatus:
          type: string
          minLength: 2
          maxLength: 64
          description: applied / approved according to workflow config
          example: applied
        serviceDetails:
          description: Service related information
          type: object
        applicants:
          type: array
          items:
            $ref: '#/components/schemas/Applicant'
        address:
           $ref: '#/components/schemas/Address'
        additionalDetails:
          description: Any additional details that need to be captured
          type: object
        auditDetails:
          $ref: https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract.yml#/definitions/AuditDetails
      required:
        - tenantId
        - businessService
        - serviceDetails
        - module

    ServiceInitRequest:
      type: object
      properties:
        RequestInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo
        Service:
          $ref: '#/components/schemas/Service'
          
    ServiceInitResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ResponseInfo
        Services:
          type: array
          items:
            $ref: '#/components/schemas/Service'
        pagination:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/367d45e50eb274ccaabeddc302bc34420edebe09/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination'

    Service:
      description: A Object which holds the info about the application details
      type: object
      properties:
        id:
          description: Unique identifier of the Service Registered
          readOnly: true
          type: string
          minLength: 2
          maxLength: 64
          example: "8801de85-f123-4e4b-9e4e-adbd04e49965"
        tenantId:
          description: Tenant Identifier
          example: pg
          type: string
          minLength: 2
          maxLength: 64
        businessService:
          type: string
          description: all the enabled service like tradelicence / propertytax etc
          minLength: 2
          maxLength: 64
          example: newTL
        module:
          type: string
          description: all the enabled service like tradelicence / propertytax etc
          minLength: 2
          maxLength: 64
          example: tradelicence
        status:
          description: enum value for the payment status 
          type: string
          enum: [INACTIVE, ACTIVE]
        additionalDetails:
          description: Any additional details that need to be captured
          type: object
        auditDetails:
          $ref: https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract.yml#/definitions/AuditDetails
      required:
        - tenantId
        - module
        - businessService

    ApplicationRequest:
      type: object
      properties:
        RequestInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo
        Application:
          $ref: '#/components/schemas/Application'
        Workflow:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Workflow
        
    ApplicationResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ResponseInfo
        Applications:
          type: array
          items:
            $ref: '#/components/schemas/Application'
        pagination:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/367d45e50eb274ccaabeddc302bc34420edebe09/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination'
    ApplicationCriteria:
      type: object
      properties:
        tenantId:
          description: Tenant Identifier
          example: pg.citya
          type: string
          minLength: 2
          maxLength: 64
        ids:
          type: array
          description: Search by bill ids 
          items:
            type: string
            example: 'c453edf5-0b89-4040-8f34-b8fbdfac1b2e'
        businessService:
          description: Search bill by business service
          example: NEWTL
          type: string
          minLength: 2
          maxLength: 64
        module:
          description: Search bill by business service
          example: tradelicence
          type: string
          minLength: 2
          maxLength: 64
        referenceId:
          description: search bill by  referance ids         
          type: array
          items:
            type: string
        applicationNo:
          maxLength: 64
          minLength: 2
          type: string
          description: Unique Application Number. This is  unique in
            system for a tenant. This is mandatory but always be generated after validation.
        status:
          $ref: '#/components/schemas/Status'
      required: 
        - tenantId
    ApplicationSearchRequest:
      type: object
      properties:
        RequestInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo
        searchCriteria:
          $ref: '#/components/schemas/ApplicationCriteria'
        pagination:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination'
    Status:
      description: enum value for the payment status 
      type: string
      enum: [INACTIVE, ACTIVE, INWORKFLOW]


    Reference:
      type: object
      properties:
        referenceId:
          description: reference id to current entity
          type: string
          minLength: 2
          maxLength: 64
          example: 8801de85-f123-4e4b-9e4e-adbd04e49965
        referenceType:
          description: Pass reference service information like billing / payment / internal
          type: string
          minLength: 2
          maxLength: 64
          example: internal
        module:
          description: Pass reference service information
          type: string
          minLength: 2
          maxLength: 64
          example: property
        tenantId:
          description: Tenant Identifier
          example: pg
          type: string
          minLength: 2
          maxLength: 64
        referenceNo:
          description: Application number / unique number
          example: pg
          type: string
          minLength: 2
          maxLength: 64
      required: 
      - referenceId
      - service
    Applicant:
      type: object
      properties:
        type:
          description: allowed usertype
          type: string
          minLength: 2
          maxLength: 64
          example: citizen inidvidual institution
        userId:
          description: Unique identifier of the User
          type: string
          minLength: 2
          maxLength: 64
          example: "8801de85-f123-4e4b-9e4e-adbd04e49965"
        id:
          description: Unique identifier 
          readOnly: true
          type: string
          minLength: 2
          maxLength: 64
          example: "8801de85-f123-4e4b-9e4e-adbd04e49965"
        name:
          description: name of the user
          type: string
          minLength: 2
          maxLength: 64
          example: John
        mobileNumber:
          type: integer
          description: Mobile number of the user
          example: 99999999999
        emailId:
          description: name of the user
          type: string
          maxLength: 64
          example: john@gmail.com  
        prefix:
          type: string
          description: country prefix
          example: +91
        active:
          type: boolean
          description: active user mapping
          example: true
          
    RecordRequest:
      type: object
      properties:
        RequestInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo
        Record:
          $ref: '#/components/schemas/Record'

    RecordResponse:
      type: object
      properties:
        ResponseInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/ResponseInfo
        Records:
          type: array
          items:
            $ref: '#/components/schemas/Record'
        pagination:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/367d45e50eb274ccaabeddc302bc34420edebe09/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination'
          
    Record:      
      description: A Object which holds the info about the record details
      type: object
      properties:
        id:
          description: Unique identifier of the record
          readOnly: true
          type: string
          minLength: 2
          maxLength: 64
          example: "8801de85-f123-4e4b-9e4e-adbd04e49965"
        tenantId:
          description: Tenant Identifier
          example: pg
          type: string
          minLength: 2
          maxLength: 64
        module:
          type: string
          description: all the enabled service like tradelicence / propertytax etc
          minLength: 2
          maxLength: 64
          example: tradelicence
        
        recordNo:
          maxLength: 64
          minLength: 2
          type: string
          description: Unique Record Number. This is  unique in
            system for a tenant. This is mandatory but always be generated after validation.
          readOnly: true
        validTill:
          description:  epoch of the time since till this record is valid
          readOnly: true
          type: integer
          format: int64
        status:
          $ref: '#/components/schemas/Status'
        serviceDetails:
          description: Service related information
          type: object
        applicationDetails:
          description: Application related information
          type: object
          properties:
            applicationNo:
              maxLength: 64
              minLength: 2
              type: string
              description: Unique Application Number
            applicationId:
              maxLength: 64
              minLength: 2
              type: string
              description: Application UUID
            businessService:
              maxLength: 64
              minLength: 2
              type: string
              description: Application BusinessService
        owner:
          type: array
          items:
            $ref: '#/components/schemas/Applicant'
        address:
          $ref: '#/components/schemas/Address' 
                  
        additionalDetails:
          description: Any additional details that need to be captured
          type: object
        auditDetails:
          $ref: https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract.yml#/definitions/AuditDetails
      required:
        - tenantId
        - businessService
        - serviceDetails
        - module

    RecordCriteria:
      type: object
      properties:
        tenantId:
          description: Tenant Identifier
          example: pg.citya
          type: string
          minLength: 2
          maxLength: 64
        ids:
          type: array
          description: Search by bill ids 
          items:
            type: string
            example: 'c453edf5-0b89-4040-8f34-b8fbdfac1b2e'
        businessService:
          description: Search bill by business service
          example: WORKS-MUSTERROLE
          type: string
          minLength: 2
          maxLength: 64
        applicationNo:
          maxLength: 64
          minLength: 2
          type: string
          description: Unique Application Number. This is  unique in
            system for a tenant. This is mandatory but always be generated after validation.
        recordNo:
          maxLength: 64
          minLength: 2
          type: string
          description: Unique Application Number. This is  unique in
            system for a tenant. This is mandatory but always be generated after validation.
        status:
          $ref: '#/components/schemas/Status'
      required: 
        - tenantId
    RecordSearchRequest:
      type: object
      properties:
        RequestInfo:
          $ref: >-
                https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/RequestInfo
        searchCriteria:
          $ref: '#/components/schemas/RecordCriteria'
        pagination:
          $ref: 'https://raw.githubusercontent.com/egovernments/DIGIT-OSS/master/core-services/docs/common-contract_v1-1.yml#/components/schemas/Pagination'
